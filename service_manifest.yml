name: FrankenStrings
version: 1
description: Suspicious String Monster.

accepts: .*
rejects: empty|metadata/.*

stage: CORE
category: Static Analysis

file_required: true
timeout: 300
disable_cache: false

enabled: true
is_external: false
licence_count: 0

config:
  max_size: 3000000
  max_length: 5000
  st_max_size: 0
  bb_max_size: 85000

heuristics:
  - heur_id: 1
    name: Base64_Decoded
    score: 10
    filetype: '*'
    description: Base64-like strings discovered and decoded.

  - heur_id: 2
    name: XOR_decoded
    score: 500
    filetype: '*'
    description: XOR'd IOC content found and decoded.

  - heur_id: 3
    name: Embedded_PE
    score: 100
    filetype: '*'
    description: Embedded PE extracted.

  - heur_id: 4
    name: Unicode_decoded
    score: 10
    filetype: '*'
    description: Unicode-like data found and decoded in non-exectuable file.

  - heur_id: 5
    name: Unicode_file_extracted
    score: 100
    filetype: '*'
    description: Long section of unicode-like data found and extracted in non-executable file.

  - heur_id: 6
    name: IOC_unicode_decoded
    score: 500
    filetype: '*'
    description: IOC(s) found in unicode encoded data in non-exectuable file.

  - heur_id: 7
    name: ASCIIhex_file_decoded
    score: 50
    filetype: '*'
    description: Possible ASCII hex encoded file decoded in non-executable file.

  - heur_id: 8
    name: ASCIIhex_strings_decoded
    score: 500
    filetype: '*'
    description: ASCII hex-like strings found and decoded in a non-document, non-executable file.
      -
  - heur_id: 9
    name: ASCIIhex_xor_string
    score: 500
    filetype: '*'
    description: Possible ASCII hex-like string with additional xor encoding found.

  - heur_id: 10
    name: ASCIIhex_strings_decoded_doc
    score: 10
    filetype: 'document/'
    description: ASCII hex-like strings found and decoded in a document file

  - description: Only a few de-obfuscation attemp needed to deobfuscate the file
    filetype: (code/.*|unknown)
    heur_id: 11
    name: Simple obfuscation
    score: 10
  - description: The service attempted between 5 and 10 de-obfuscation attemps
    filetype: (code/.*|unknown)
    heur_id: 12
    name: Light obfuscation
    score: 50
  - description: The service attempted between 10 and 50 de-obfuscation attemps
    filetype: (code/.*|unknown)
    heur_id: 13
    name: Medium obfuscation
    score: 100
  - description: The service attempted between 50 and 100 de-obfuscation attemps
    filetype: (code/.*|unknown)
    heur_id: 14
    name: Very high obfuscation
    score: 500
  - description: The service attempted more than a 100 de-obfuscation attemps
    filetype: (code/.*|unknown)
    heur_id: 15
    name: Extreme obfuscation
    score: 1000
  - description: IOCs where found only after de-obfuscation
    filetype: (code/.*|unknown)
    heur_id: 16
    name: De-obfuscated IOCs
    score: 500
  - heur_id: 17
    name: Crobar extracted file
    score: 10
    filetype: 'code/'
    description: Deobfuscated code of interest extracted

docker_config:
  image: ${REGISTRY}cccs/assemblyline-service-frankenstrings:latest
  cpu_cores: 1
  ram_mb: 512
